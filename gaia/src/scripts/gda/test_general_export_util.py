from scripts.gda.gale_data_archive import GaleDataArchive
import unittest
import StringIO
import logging


#
# ensure that local mounts + db
# run this script
# copy and run patch.sh in folder with .xml files
# as data_serices run ./create_new_manifest.sh /home/data_services/cho/items/all
#    RE: /gaia/src/scripts/live/create_new_manifest.sh

#
class TestGeneralExportUtil(unittest.TestCase):
    def test_general_export_util(self):
        gda = GaleDataArchive(log_level=logging.DEBUG)
        # gda_folder = '/mnt/UKDEV/pgref'
        gda_folder = '/mnt/UKDEV/pgref'


        from_excel = """cho_bcrc_1934_palmer_000_0000
cho_bcrc_1938_0003_000_0000
cho_bcrc_1945_0002_000_0000
cho_bcrc_1954_0000_000_0000
cho_binx_1925_0001_000_0000
cho_binx_1926_0002_000_0000
cho_binx_1929-1930_0006_000_0000
cho_binx_1931-1932_0008_000_0000
cho_binx_1933-1934_0010_000_0000
cho_binx_1934-1935_0011_000_0000
cho_binx_1936-1937_0013_000_0000
cho_binx_1938_0015_001_0000
cho_binx_1938_0015_002_0000
cho_binx_1939_0016_001_0000
cho_binx_1939_0016_002_0000
cho_binx_1940_0017_000_0000
cho_binx_1940_0017_001_0000
cho_binx_1941_0018_002_0000
cho_binx_1942_0019_000_0000
cho_binx_1943_0020_000_0000
cho_binx_1945_0022_000_0000
cho_book_1924_temperley_003_0000
cho_book_1930_latimer_000_0000
cho_book_1932_0000_001_0000
cho_book_1933_arnold_000_0000
cho_book_1933_grubb_000_0000
cho_book_1933_windett_000_0000
cho_book_1934_palmer_000_0000
cho_book_1935_0000_000_0000
cho_book_1935_howard_000_0000
cho_book_1935_hubbard_000_0000
cho_book_1935_riia_000_0000
cho_book_1936_carr_000_0000
cho_book_1936_morrow_000_0000
cho_book_1936_papers_000_0000
cho_book_1937_kuczynski_000_0000
cho_book_1938_0000_002_0000
cho_book_1938_0000_003_0000
cho_book_1938_0000_004_0000
cho_book_1938_frankel_000_0000
cho_book_1938_hodson_000_0000
cho_book_1938_palmer_000_0000
cho_book_1938_riia_000_0000
cho_book_1938_wiskermann_000_0000
cho_book_1939_0006_000_0000
cho_book_1939_Kuczynski_000_0000
cho_book_1940_jones_000_0000
cho_book_1940_papersriia_001_0000
cho_book_1942_0002_002_0000
cho_book_1942_kaeckenbeeck_000_0000
cho_book_1942_whyte_000_0000
cho_book_1943_0000_000_0000
cho_book_1943_brown_000_0000
cho_book_1943_gull_001_0000
cho_book_1943_gull_002_0000
cho_book_1943_hailey_000_0000
cho_book_1943_mance_001_0000
cho_book_1943_mance_005_0000
cho_book_1944_0000_000_0000
cho_book_1944_leubusher_000_0000
cho_book_1944_whyte_000_0000
cho_book_1945_0000_000_0000
cho_book_1945_Dewar_000_0000
cho_book_1945_kahler_000_0000
cho_book_1945_mackay_000_0000
cho_book_1946_0000_001_0000
cho_book_1946_mackay_000_0000
cho_book_1946_miniopaluello_000_0000
cho_book_1946_parkes_000_0000
cho_book_1946_thomson_000_0000
cho_book_1946_wedgewood_000_0000
cho_book_1947_beloff_000_0000
cho_book_1947_grindrod_000_0000
cho_book_1947_hourani_000_0000
cho_book_1947_issawi_000_0000
cho_book_1947_Meyer_000_0000
cho_book_1948_0000_001_0000
cho_book_1948_0000_002_0000
cho_book_1948_0001_002_0000
cho_book_1948_kuczynski_000_0000
cho_book_1948_meyer_000_0000
cho_book_1948_purcell_000_0000
cho_book_1948_warriner_000_0000
cho_book_1949_0000_000_0000
cho_book_1949_bidwell_000_0000
cho_book_1949_jones_000_0000
cho_book_1949_kuczynski_000_0000
cho_book_1950_0000_001_0000
cho_book_1950_0000_002_0000
cho_book_1950_rothschild_000_0000
cho_book_1951_0000_000_0000
cho_book_1951_0001_001_0000
cho_book_1951_0001_002_0000
cho_book_1951_0001_003_0000
cho_book_1951_butland_000_0000
cho_book_1951_dewar_000_0000
cho_book_1951_plant_000_0000
cho_book_1952_kemaeny_000_0000
cho_book_1952_pendle_000_0000
cho_book_1952_smith_000_0000
cho_book_1953_0003_000_0000
cho_book_1953_galbraith_000_0000
cho_book_1953_lambton_000_0000
cho_book_1954_0009_000_0000
cho_book_1954_0010_000_0000
cho_book_1954_camacho_000_0000
cho_book_1954_linke_000_0000
cho_book_1954_osborne_000_0000
cho_book_1954_pendee_000_0000
cho_book_1954_sweetescott_000_0000
cho_book_1955_grindrod_000_0000
cho_book_1955_meade_001_0000
cho_book_1956_laugharne_000_0000
cho_book_1956_leubuscher_000_0000
cho_book_1957_cagle_000_0000
cho_book_1957_farmer_000_0000
cho_book_1957_fawzi_000_0000
cho_book_1957_Hailey_001_0000
cho_book_1957_pendle_000_0000
cho_book_1957_warriner_000_0000
cho_book_1958_allen_000_0000
cho_book_1958_bullard_000_0000
cho_book_1958_jones_000_0000
cho_book_1958_rangnekar_000_0000
cho_book_1958_thomson_000_0000
cho_book_1959_barbour_000_0000
cho_book_1960_0000_000_0000
cho_book_1960_linke_000_0000
cho_book_1960_szczepanik_000_0000
cho_book_1961_hughes_000_0000
cho_book_1961_lewis_000_0000
cho_book_1961_misra_000_0000
cho_book_1962_baer_000_0000
cho_book_1962_cline_000_0000
cho_book_1962_lutz_000_0000
cho_book_1962_meade_000_0000
cho_book_1962_smith_000_0000
cho_book_1962_warriner_000_0000
cho_book_1963_reeve_000_0000
cho_book_1964_haseeb_000_0000
cho_book_1964_ionescu_000_0000
cho_book_1964_mcmahon_000_0000
cho_book_1964_owens_000_0000
cho_book_1964_zauberman_000_0000
cho_book_1965_allen_000_0000
cho_book_1965_osborne_000_0000
cho_book_1965_parker_000_0000
cho_book_1965_pendle_000_0000
cho_book_1965_purcell_000_0000
cho_book_1965_shonfield_000_0000
cho_book_1965_swainiewicz_000_0000
cho_book_1965_vaeliz_000_0000
cho_book_1966_austin_000_0000
cho_book_1966_austin_001_0000
cho_book_1966_galbraith_000_0000
cho_book_1966_hanson_000_0000
cho_book_1967_gittings_000_0000
cho_book_1967_hazlewood_000_0000
cho_book_1967_McLachlan_000_0000
cho_book_1967_saab_000_0000
cho_book_1967_strange_000_0000
cho_book_1967_tinker_001_0000
cho_book_1967_toynbee_000_0000
cho_book_1967_veliz_000_0000
cho_book_1967_warley_000_0000
cho_book_1968_coombes_000_0000
cho_book_1968_dosser_000_0000
cho_book_1968_kaiser_000_0000
cho_book_1968_logan_000_0000
cho_book_1968_pendle_000_0000
cho_book_1968_streeten_000_0000
cho_book_1969_0000_000_0000
cho_book_1969_beever_000_0000
cho_book_1969_blythe_000_0000
cho_book_1969_despicht_000_0000
cho_book_1969_gray_000_0000
cho_book_1969_higgins_000_0000
cho_book_1969_lambton_000_0000
cho_book_1969_landau_000_0000
cho_book_1969_lieuwen_000_0000
cho_book_1970_0000_000_0000
cho_book_1970_higgins_000_0000
cho_book_1970_kadt_000_0000
cho_book_1971_hutchings_000_0000
cho_book_1971_marsh_000_0000
cho_book_1971_strange_000_0000
cho_book_1972_dobell_000_0000
cho_book_1972_mayne_000_0000
cho_book_1973_darby_000_0000
cho_book_1974_bar_000_0000
cho_book_1975_connelly_000_0000
cho_book_1975_frankel_000_0000
cho_book_1975_lawson_000_0000
cho_book_1975_lipton_000_0000
cho_book_1975_mcinnes_000_0000
cho_book_1976_0002_000_0000
cho_book_1976_russell_000_0000
cho_book_1976_wallace_000_0000
cho_book_1976_zauberman_000_0000
cho_book_1978_mendl_000_0000
cho_book_1979_beazley_000_0000
cho_book_1979_brownlie_000_0000
cho_book_1979_hanabusa_000_0000
cho_book_1979_harris_000_0000
cho_book_1979_irving_000_0000
cho_book_1979_turner_000_0000
cho_book_1999_0000_007_0000
cho_byil_1921_0002_000_0000
cho_byil_1927_0008_000_0000
cho_byil_1938_0019_000_0000
cho_byil_1960_0036_000_0000
cho_chrx_1969_0000_000_0000
cho_chrx_1969_despicht_000_0000
cho_chrx_1971_marsh_000_0000
cho_diax_1928_0000_000_0000
cho_diax_1929_0000_000_0000
cho_diax_1931_0000_000_0000
cho_diax_1932_0000_000_0000
cho_diax_1934_0000_000_0000
cho_diax_1935_0002_000_0000
cho_diax_1937_0000_000_0000
cho_diax_1953_0000_000_0000
cho_diax_1959_0000_000_0000
cho_iaxx_1928_0007_000_0000
cho_iaxx_1930_0009_000_0000
cho_iaxx_1931_0010_000_0000
cho_iaxx_1932_0011_000_0000
cho_iaxx_1933_0012_000_0000
cho_iaxx_1939_0018_000_0000
cho_iaxx_1944_0020_000_0000
cho_iaxx_1946_0022_000_0000
cho_iaxx_1952_0028_000_0000
cho_iaxx_1956_0032_000_0000
cho_iaxx_1961_0037_000_0000
cho_iaxx_1966_0042_000_0000
cho_iaxx_1971_0047_000_0000
cho_iaxx_1972_0048_000_0000
cho_iaxx_1973_0049_000_0000
cho_iprx_1927_0000_000_0000
cho_iprx_1931_0000_000_0000
cho_iprx_1931_0003_000_0000
cho_iprx_1931_0012_000_0000
cho_iprx_1931_0013_000_0000
cho_iprx_1931_0014_000_0000
cho_iprx_1931_0016_000_0000
cho_iprx_1931_0017_000_0000
cho_iprx_1931_0019_000_0000
cho_iprx_1933_0000_002_0000
cho_iprx_1933_0003_001_0000
cho_iprx_1933_0004_001_0000
cho_iprx_1933_0005_000_0000
cho_iprx_1933_0007_001_0000
cho_iprx_1933_0007_002_0000
cho_iprx_1933_0008_000_0000
cho_iprx_1933_0009_000_0000
cho_iprx_1933_0010_000_0000
cho_iprx_1933_0011_000_0000
cho_iprx_1933_0012_000_0000
cho_iprx_1933_0013_000_0000
cho_iprx_1933_0014_000_0000
cho_iprx_1936_0000_001_0000
cho_iprx_1936_0001_001_0000
cho_iprx_1936_0002_000_0000
cho_iprx_1936_0004_000_0000
cho_iprx_1936_0004_001_0000
cho_iprx_1936_0005_000_0000
cho_iprx_1936_0006_000_0000
cho_iprx_1936_0007_000_0000
cho_iprx_1936_0008_000_0000
cho_iprx_1936_0009_000_0000
cho_iprx_1936_0010_000_0000
cho_iprx_1936_0011_000_0000
cho_iprx_1936_0012_000_0000
cho_iprx_1936_0013_000_0000
cho_iprx_1936_0014_000_0000
cho_iprx_1936_0017_000_0000
cho_iprx_1939_0000_001_0000
cho_iprx_1939_0002_001_0000
cho_iprx_1939_0003_001_0000
cho_iprx_1942_0002_000_0000
cho_iprx_1942_0003_000_0000
cho_iprx_1942_0004_000_0000
cho_iprx_1942_0005_000_0000
cho_iprx_1942_0007_000_0000
cho_iprx_1942_0008_000_0000
cho_iprx_1942_0009_000_0000
cho_iprx_1945_0002_001_0000
cho_iprx_1945_0004_000_0000
cho_iprx_1945_0005_000_0000
cho_iprx_1945_0006_000_0000
cho_iprx_1945_0007_000_0000
cho_iprx_1945_0008_000_0000
cho_iprx_1947_0002_000_0000
cho_iprx_1947_0003_000_0000
cho_iprx_1947_0004_000_0000
cho_iprx_1947_0005_000_0000
cho_iprx_1947_0006_000_0000
cho_iprx_1950_0002_000_0000
cho_iprx_1950_0003_000_0000
cho_iprx_1954_0002_000_0000
cho_iprx_1954_0003_000_0000
cho_iprx_1958_0002_000_0000
cho_rfpc_1940-1942L_0000_030_0000
cho_rfpc_1940-1942L_0000_045_0000
cho_rfpc_1940-1942L_0000_048_0000
cho_rfpc_1940-1942L_0000_050_0000
cho_rfpc_1940-1942L_0000_053_0000
cho_rfpc_1940-1942L_0000_054_0000
cho_rfpc_1940-1942L_0000_058_0000
cho_rfpc_1940-1942L_0000_060_0000
cho_rfpc_1940-1942L_0000_063_0000
cho_rfpc_1940-1942L_0000_065_0000
cho_rfpc_1940-1942L_0000_066_0000
cho_rfpc_1940-1942L_0000_067_0000
cho_rfpc_1940-1942L_0000_068_0000
cho_rfpc_1940-1942L_0000_070_0000
cho_rfpc_1940-1942L_0000_079_0000
cho_rfpc_1940-1942L_0000_088_0000
cho_rfpc_1940-1942L_0000_092_0000
cho_rfpc_1940-1942L_0000_094_0000
cho_rfpc_1940-1942L_0000_106_0000
cho_rfpc_1940-1942L_0000_112_0000
cho_rfpc_1940-1942L_0000_114_0000
cho_rfpc_1940-1942L_0000_117_0000
cho_rfpc_1943-1945L_0000_001_0000
cho_rfpc_1943-1945L_0000_002_0000
cho_rfpc_1943-1945L_0000_003_0000
cho_rfpc_1943-1945L_0000_005_0000
cho_rfpc_1943-1945L_0000_006_0000
cho_rfpc_1943-1945L_0000_008_0000
cho_rfpc_1943-1945L_0000_009_0000
cho_rfpc_1943-1945L_0000_010_0000
cho_rfpc_1943-1945L_0000_011_0000
cho_rfpc_1943-1945L_0000_012_0000
cho_rfpc_1943-1945L_0000_013_0000
cho_rfpc_1943-1945L_0000_014_0000
cho_rfpc_1943-1945L_0000_015_0000
cho_rfpc_1943-1945L_0000_016_0000
cho_rfpc_1943-1945L_0000_017_0000
cho_rfpc_1943-1945L_0000_018_0000
cho_rfpc_1943-1945L_0000_019_0000
cho_rfpc_1943-1945L_0000_020_0000
cho_rfpc_1943-1945L_0000_021_0000
cho_rfpc_1943-1945L_0000_023_0000
cho_rfpc_1943-1945L_0000_024_0000
cho_rfpc_1943-1945L_0000_025_0000
cho_rfpc_1943-1945L_0000_026_0000
cho_rfpc_1943-1945L_0000_027_0000
cho_rfpc_1943-1945L_0000_028_0000
cho_rfpc_1943-1945L_0000_029_0000
cho_rfpc_1943-1945L_0000_030_0000
cho_rfpc_1943-1945L_0000_031_0000
cho_rfpc_1943-1945L_0000_033_0000
cho_rfpc_1943-1945L_0000_034_0000
cho_rfpc_1943-1945L_0000_035_0000
cho_rfpc_1943-1945L_0000_036_0000
cho_rfpc_1943-1945L_0000_037_0000
cho_rfpc_1943-1945L_0000_038_0000
cho_rfpc_1943-1945L_0000_039_0000
cho_rfpc_1943-1945L_0000_040_0000
cho_rfpc_1943-1945L_0000_041_0000
cho_rfpc_1943-1945L_0000_042_0000
cho_rfpc_1943-1945L_0000_043_0000
cho_rfpc_1943-1945L_0000_044_0000
cho_rfpc_1943-1945L_0000_045_0000
cho_rfpc_1943-1945L_0000_046_0000
cho_rfpc_1943-1945L_0000_047_0000
cho_rfpc_1943-1945L_0000_048_0000
cho_rfpc_1943-1945L_0000_049_0000
cho_rfpc_1943-1945L_0000_050_0000
cho_rfpc_1943-1945L_0000_051_0000
cho_rfpc_1943-1945L_0000_052_0000
cho_rfpc_1943-1945L_0000_055_0000
cho_rfpc_1943-1945L_0000_058_0000
cho_rfpc_1943-1945L_0000_062_0000
cho_rfpc_1943-1945L_0000_065_0000
cho_rfpc_1943-1945L_0000_066_0000
cho_rfpc_1943-1945L_0000_067_0000
cho_rfpc_1943-1945L_0000_068_0000
cho_rfpc_1943-1945L_0000_069_0000
cho_rfpx_1939-1940E_0000_050_0000
cho_rfpx_1939A_0000_005_0000
cho_rfpx_1939A_0000_012_0000
cho_rfpx_1939C_0000_008_0000
cho_rfpx_1939C_0000_012_0000
cho_rfpx_1940-1941U_0000_011_0000
cho_rfpx_1940-1941U_0000_023_0000
cho_rfpx_1940-1941U_0000_028_0000
cho_rfpx_1940-1941U_0000_030_0000
cho_rfpx_1940-1941U_0000_036_0000
cho_rfpx_1940-1941U_0000_078_0000
cho_rfpx_1940-1941U_0000_097_0000
cho_rfpx_1940A_0000_053_0000
cho_rfpx_1940B_0000_015_0000
cho_rfpx_1940B_0000_027_0000
cho_rfpx_1940B_0000_085_0000
cho_rfpx_1940B_0000_091_0000
cho_rfpx_1940C_0000_029_0000
cho_rfpx_1940C_0000_039_0000
cho_rfpx_1940C_0000_041_0000
cho_rfpx_1940C_0000_042_0000
cho_rfpx_1940C_0000_043_0000
cho_rfpx_1940C_0000_045_0000
cho_rfpx_1940C_0000_046_0000
cho_rfpx_1940C_0000_048_0000
cho_rfpx_1940C_0000_049_0000
cho_rfpx_1940C_0000_052_0000
cho_rfpx_1940C_0000_053_0000
cho_rfpx_1940C_0000_054_0000
cho_rfpx_1940C_0000_055_0000
cho_rfpx_1940C_0000_058_0000
cho_rfpx_1940C_0000_059_0000
cho_rfpx_1940C_0000_060_0000
cho_rfpx_1940C_0000_061_0000
cho_rfpx_1940C_0000_063_0000
cho_rfpx_1940C_0000_064_0000
cho_rfpx_1941-1943C_0000_067_0000
cho_rfpx_1941-1943C_0000_068_0000
cho_rfpx_1941-1943C_0000_069_0000
cho_rfpx_1941-1943C_0000_070_0000
cho_rfpx_1941-1943C_0000_071_0000
cho_rfpx_1941-1943C_0000_073_0000
cho_rfpx_1941-1943C_0000_078_0000
cho_rfpx_1941-1943C_0000_080_0000
cho_rfpx_1941-1943C_0000_081_0000
cho_rfpx_1941-1943C_0000_084_0000
cho_rfpx_1941-1943C_0000_085_0000
cho_rfpx_1941-1943C_0000_087_0000
cho_rfpx_1941-1943C_0000_088_0000
cho_rfpx_1941-1943C_0000_089_0000
cho_rfpx_1941-1943C_0000_090_0000
cho_rfpx_1941-1943C_0000_092_0000
cho_rfpx_1941-1943C_0000_093_0000
cho_rfpx_1941-1943C_0000_094_0000
cho_rfpx_1941-1943C_0000_095_0000
cho_rfpx_1941-1943C_0000_097_0000
cho_rfpx_1941-1943C_0000_099_0000
cho_rfpx_1941-1943C_0000_100_0000
cho_rfpx_1941-1943C_0000_103_0000
cho_rfpx_1941-1943C_0000_104_0000
cho_rfpx_1941-1943C_0000_105_0000
cho_rfpx_1941-1943C_0000_108_0000
cho_rfpx_1941-1943C_0000_109_0000
cho_rfpx_1941-1943C_0000_111_0000
cho_rfpx_1941-1943C_0000_113_0000
cho_rfpx_1941-1943C_0000_115_0000
cho_rfpx_1941-1943C_0000_116_0000
cho_rfpx_1941-1943C_0000_120_0000
cho_rfpx_1941-1943C_0000_121_0000
cho_rfpx_1941-1943C_0000_122_0000
cho_rfpx_1941-1943C_0000_123_0000
cho_rfpx_1941-1943C_0000_124_0000
cho_rfpx_1941-1943C_0000_126_0000
cho_rfpx_1941-1943C_0000_132_0000
cho_rfpx_1941-1943C_0000_133_0000
cho_rfpx_1941-1943C_0000_134_0000
cho_rfpx_1941-1943C_0000_135_0000
cho_rfpx_1941-1943C_0000_140_0000
cho_rfpx_1941-1943C_0000_141_0000
cho_rfpx_1941-1943C_0000_142_0000
cho_rfpx_1941-1943C_0000_144_0000
cho_rfpx_1941-1943C_0000_145_0000
cho_rfpx_1941-1943C_0000_146_0000
cho_rfpx_1941-1943C_0000_148_0000
cho_rfpx_1941-1943C_0000_149_0000
cho_rfpx_1941-1943C_0000_150_0000
cho_rfpx_1941-1943C_0000_151_0000
cho_rfpx_1941-1943C_0000_152_0000
cho_rfpx_1941-1943C_0000_154_0000
cho_rfpx_1941-1943C_0000_155_0000
cho_rfpx_1941-1943C_0000_156_0000
cho_rfpx_1941-1943C_0000_157_0000
cho_rfpx_1941-1943C_0000_158_0000
cho_rfpx_1941-1943C_0000_160_0000
cho_rfpx_1941-1943C_0000_162_0000
cho_rfpx_1941-1943C_0000_163_0000
cho_rfpx_1941-1943C_0000_165_0000
cho_rfpx_1941-1943C_0000_166_0000
cho_rfpx_1941-1943C_0000_167_0000
cho_rfpx_1941-1943C_0000_168_0000
cho_rfpx_1941-1943C_0000_171_0000
cho_rfpx_1941-1943C_0000_172_0000
cho_rfpx_1941-1945E_0000_118_0000
cho_rfpx_1941-1945E_0000_142_0000
cho_rfpx_1941-1945E_0000_221_0000
cho_rfpx_1941A_0000_069_0000
cho_rfpx_1941A_0000_075_0000
cho_rfpx_1941A_0000_084_0000
cho_rfpx_1941A_0000_100_0000
cho_rfpx_1941A_0000_109_0000
cho_rfpx_1941A_0000_114_0000
cho_rfpx_1941B_0000_102_0000
cho_rfpx_1942-1945U_0000_107_0000
cho_rfpx_1942-1945U_0000_112_0000
cho_rfpx_1942-1945U_0000_148_0000
cho_rfpx_1942-1945U_0000_155_0000
cho_rfpx_1942-1945U_0000_156_0000
cho_rfpx_1942-1945U_0000_157_0000
cho_rfpx_1942-1945U_0000_158_0000
cho_rfpx_1942-1945U_0000_159_0000
cho_rfpx_1942-1945U_0000_160_0000
cho_rfpx_1942-1945U_0000_161_0000
cho_rfpx_1942-1945U_0000_162_0000
cho_rfpx_1942-1945U_0000_163_0000
cho_rfpx_1942-1945U_0000_164_0000
cho_rfpx_1942-1945U_0000_165_0000
cho_rfpx_1942-1945U_0000_166_0000
cho_rfpx_1942-1945U_0000_167_0000
cho_rfpx_1942-1945U_0000_169_0000
cho_rfpx_1942-1945U_0000_170_0000
cho_rfpx_1942-1945U_0000_171_0000
cho_rfpx_1942-1945U_0000_172_0000
cho_rfpx_1942-1945U_0000_173_0000
cho_rfpx_1942-1945U_0000_174_0000
cho_rfpx_1942-1945U_0000_175_0000
cho_rfpx_1942-1945U_0000_176_0000
cho_rfpx_1942-1945U_0000_178_0000
cho_rfpx_1942-1945U_0000_179_0000
cho_rfpx_1942-1945U_0000_180_0000
cho_rfpx_1942-1945U_0000_181_0000
cho_rfpx_1942-1945U_0000_182_0000
cho_rfpx_1942-1945U_0000_183_0000
cho_rfpx_1942-1945U_0000_187_0000
cho_rfpx_1942-1945U_0000_188_0000
cho_rfpx_1942-1945U_0000_189_0000
cho_rfpx_1942-1945U_0000_192_0000
cho_rfpx_1942-1945U_0000_194_0000
cho_rfpx_1942-1945U_0000_195_0000
cho_rfpx_1942-1945U_0000_196_0000
cho_rfpx_1942-1945U_0000_197_0000
cho_rfpx_1942-1945U_0000_198_0000
cho_rfpx_1942-1945U_0000_200_0000
cho_rfpx_1942-1945U_0000_201_0000
cho_rfpx_1942-1945U_0000_202_0000
cho_rfpx_1942-1945U_0000_204_0000
cho_rfpx_1942-1945U_0000_205_0000
cho_rfpx_1942-1945U_0000_206_0000
cho_rfpx_1942-1945U_0000_207_0000
cho_rfpx_1942-1945U_0000_208_0000
cho_rfpx_1942-1945U_0000_209_0000
cho_rfpx_1942-1945U_0000_210_0000
cho_rfpx_1942-1945U_0000_212_0000
cho_rfpx_1942-1945U_0000_213_0000
cho_rfpx_1942-1945U_0000_214_0000
cho_rfpx_1942-1945U_0000_215_0000
cho_rfpx_1942-1945U_0000_219_0000
cho_rfpx_1942-1945U_0000_220_0000
cho_rfpx_1942-1945U_0000_223_0000
cho_rfpx_1942-1945U_0000_224_0000
cho_rfpx_1942-1945U_0000_225_0000
cho_rfpx_1942-1945U_0000_226_0000
cho_rfpx_1942-1945U_0000_229_0000
cho_rfpx_1942-1945U_0000_234_0000
cho_rfpx_1942-1945U_0000_238_0000
cho_rfpx_1942-1945U_0000_242_0000
cho_rfpx_1942-1945U_0000_243_0000
cho_rfpx_1942B_0000_125_0000
cho_rfpx_1942B_0000_165_0000
cho_rfpx_1943-1945B_0000_167_0000
cho_rfpx_1943-1945B_0000_174_0000
cho_rfpx_1943-1945B_0000_175_0000
cho_rfpx_1943-1945B_0000_183_0000
cho_rfpx_1943-1945B_0000_184_0000
cho_rfpx_1943-1945B_0000_185_0000
cho_rfpx_1943-1945B_0000_186_0000
cho_rfpx_1943-1945B_0000_187_0000
cho_rfpx_1943-1945B_0000_188_0000
cho_rfpx_1943-1945B_0000_190_0000
cho_rfpx_1943-1945B_0000_193_0000
cho_rfpx_1943-1945B_0000_197_0000
cho_rfpx_1943-1945B_0000_201_0000
cho_rfpx_1943-1945B_0000_237_0000
cho_rfpx_1943-1945B_0000_258_0000
cho_rfpx_1943-1945B_0000_284_0000
cho_rfpx_1943-1945F_0000_001_0000
cho_rfpx_1943-1945F_0000_002_0000
cho_rfpx_1943-1945F_0000_003_0000
cho_rfpx_1943-1945F_0000_004_0000
cho_rfpx_1943-1945F_0000_005_0000
cho_rfpx_1943-1945F_0000_006_0000
cho_rfpx_1943-1945F_0000_007_0000
cho_rfpx_1943-1945F_0000_008_0000
cho_rfpx_1943-1945F_0000_009_0000
cho_rfpx_1943-1945F_0000_010_0000
cho_rfpx_1943-1945F_0000_011_0000
cho_rfpx_1943-1945F_0000_012_0000
cho_rfpx_1943-1945F_0000_013_0000
cho_rfpx_1943-1945F_0000_014_0000
cho_rfpx_1943-1945F_0000_015_0000
cho_rfpx_1943-1945F_0000_016_0000
cho_rfpx_1943-1945F_0000_017_0000
cho_rfpx_1943-1945F_0000_018_0000
cho_rfpx_1943-1945F_0000_019_0000
cho_rfpx_1943-1945F_0000_020_0000
cho_rfpx_1943-1945F_0000_021_0000
cho_rfpx_1943-1945F_0000_022_0000
cho_rfpx_1943-1945F_0000_023_0000
cho_rfpx_1943-1945F_0000_024_0000
cho_rfpx_1943-1945F_0000_025_0000
cho_rfpx_1943-1945F_0000_026_0000
cho_rfpx_1943-1945F_0000_027_0000
cho_rfpx_1943-1945F_0000_028_0000
cho_rfpx_1943-1945F_0000_029_0000
cho_rfpx_1943-1945F_0000_030_0000
cho_rfpx_1943-1945F_0000_031_0000
cho_rfpx_1943-1945F_0000_032_0000
cho_rfpx_1943-1945F_0000_033_0000
cho_rfpx_1943-1945F_0000_034_0000
cho_rfpx_1943-1945F_0000_035_0000
cho_rfpx_1943-1945F_0000_036_0000
cho_rfpx_1943-1945F_0000_037_0000
cho_rfpx_1943-1945F_0000_038_0000
cho_rfpx_1943-1945F_0000_039_0000
cho_rfpx_1943-1945F_0000_040_0000
cho_rfpx_1943-1945F_0000_041_0000
cho_rfpx_1943-1945F_0000_042_0000
cho_rfpx_1943-1945F_0000_043_0000
cho_rfpx_1943-1945F_0000_044_0000
cho_rfpx_1943-1945F_0000_045_0000
cho_rfpx_1943-1945F_0000_046_0000
cho_rfpx_1943-1945F_0000_047_0000
cho_rfpx_1943-1945F_0000_048_0000
cho_rfpx_1943-1945F_0000_049_0000
cho_rfpx_1943-1945F_0000_050_0000
cho_rfpx_1943-1945F_0000_051_0000
cho_rfpx_1943-1945F_0000_053_0000
cho_rfpx_1943-1945F_0000_054_0000
cho_rfpx_1943-1945F_0000_055_0000
cho_rfpx_1943-1945F_0000_056_0000
cho_rfpx_1943-1945F_0000_057_0000
cho_rfpx_1943-1945F_0000_058_0000
cho_rfpx_1943-1945F_0000_059_0000
cho_rfpx_1943-1945F_0000_060_0000
cho_rfpx_1943-1945F_0000_061_0000
cho_rfpx_1943-1945F_0000_062_0000
cho_rfpx_1943-1945N_0000_001_0000
cho_rfpx_1943-1945N_0000_002_0000
cho_rfpx_1943-1945N_0000_003_0000
cho_rfpx_1943-1945N_0000_004_0000
cho_rfpx_1943-1945N_0000_005_0000
cho_rfpx_1943-1945N_0000_006_0000
cho_rfpx_1943-1945N_0000_007_0000
cho_rfpx_1943-1945N_0000_008_0000
cho_rfpx_1943-1945N_0000_009_0000
cho_rfpx_1943-1945N_0000_010_0000
cho_rfpx_1943-1945N_0000_011_0000
cho_rfpx_1943-1945N_0000_012_0000
cho_rfpx_1943-1945N_0000_013_0000
cho_rfpx_1943-1945N_0000_014_0000
cho_rfpx_1943-1945N_0000_015_0000
cho_rfpx_1943-1945N_0000_016_0000
cho_rfpx_1943-1945N_0000_017_0000
cho_rfpx_1943-1945N_0000_018_0000
cho_rfpx_1943-1945N_0000_019_0000
cho_rfpx_1943-1945N_0000_020_0000
cho_rfpx_1943-1945N_0000_021_0000
cho_rfpx_1943-1945N_0000_022_0000
cho_rfpx_1943-1945N_0000_023_0000
cho_rfpx_1943-1945N_0000_024_0000
cho_rfpx_1943-1945N_0000_025_0000
cho_rfpx_1943-1945N_0000_026_0000
cho_rfpx_1943-1945N_0000_027_0000
cho_rfpx_1943-1945N_0000_028_0000
cho_rfpx_1943-1945N_0000_029_0000
cho_rfpx_1943-1945N_0000_030_0000
cho_rfpx_1943-1945N_0000_031_0000
cho_rfpx_1943-1945N_0000_032_0000
cho_rfpx_1943-1945N_0000_033_0000
cho_rfpx_1943-1945N_0000_034_0000
cho_rfpx_1943-1945N_0000_035_0000
cho_rfpx_1943-1945N_0000_036_0000
cho_rfpx_1943-1945N_0000_037_0000
cho_rfpx_1943-1945N_0000_038_0000
cho_rfpx_1943-1945N_0000_039_0000
cho_rfpx_1943-1945N_0000_040_0000
cho_rfpx_1943-1945N_0000_041_0000
cho_rfpx_1943-1945N_0000_042_0000
cho_rfpx_1943-1945N_0000_043_0000
cho_rfpx_1943-1945N_0000_044_0000
cho_rfpx_1943-1945N_0000_045_0000
cho_rfpx_1943-1945N_0000_046_0000
cho_rfpx_1943-1945N_0000_047_0000
cho_rfpx_1943-1945N_0000_048_0000
cho_rfpx_1943-1945N_0000_049_0000
cho_rfpx_1943-1945N_0000_050_0000
cho_rfpx_1943-1945N_0000_051_0000
cho_rfpx_1943-1945N_0000_052_0000
cho_rfpx_1943-1945N_0000_053_0000
cho_rfpx_1943A_0000_173_0000
cho_rfpx_1943A_0000_176_0000
cho_rfpx_1943A_0000_177_0000
cho_rfpx_1943A_0000_178_0000
cho_rfpx_1943A_0000_179_0000
cho_rfpx_1943A_0000_180_0000
cho_rfpx_1943A_0000_181_0000
cho_rfpx_1943A_0000_182_0000
cho_rfpx_1943A_0000_183_0000
cho_rfpx_1943A_0000_184_0000
cho_rfpx_1943A_0000_185_0000
cho_rfpx_1943A_0000_186_0000
cho_rfpx_1943A_0000_187_0000
cho_rfpx_1943A_0000_188_0000
cho_rfpx_1943A_0000_189_0000
cho_rfpx_1943A_0000_190_0000
cho_rfpx_1943A_0000_191_0000
cho_rfpx_1943A_0000_192_0000
cho_rfpx_1943W_0000_050_0000
cho_rfpx_1943W_0000_059_0000
cho_rfpx_1943W_0000_085_0000
cho_rfpx_1943W_0000_103_0000
cho_rfpx_1943W_0000_121_0000
cho_rfpx_1944-1945A_0000_161_0000
cho_rfpx_1944-1945A_0000_231_0000
cho_rfpx_1944-1945A_0000_260_0000
cho_rfpx_1944-1945A_0000_275_0000
cho_rfpx_1944-1945A_0000_307_0000
cho_rpax_1941_whyte_000_0000
cho_rpax_1967_strange_000_0000
cho_rpax_1967_warley_000_0000
cho_rpax_1968_coombes_000_0000
cho_rpax_1968_dosser_000_0000
cho_rpax_1969_beever_000_0000
cho_rsxx_1937-1938_0002_000_0000
cho_rsxx_1937-1938_0003_000_0000
cho_rsxx_1937-1938_0004_000_0000
cho_rsxx_1937-1938_0007_000_0000
cho_rsxx_1937-1938_0008_000_0000
cho_rsxx_1937-1938_0009_000_0000
cho_rsxx_1937-1938_0010_000_0000
cho_rsxx_1937-1938_0011_000_0000
cho_rsxx_1938_simpson_000_0000
cho_rsxx_1939_simpson_001_0000
cho_rsxx_1939_simpson_002_0000
cho_sbca_1918-1936_0001_000_0000
cho_sbca_1918-1939_0002_001_0000
cho_sbca_1918-1939_0002_002_0000
cho_sbca_1931-1939_0003_000_0000
cho_siax_1925_0002_000_0000
cho_siax_1926_0000_000_0000
cho_siax_1927_0000_000_0000
cho_siax_1928_0000_000_0000
cho_siax_1930_0000_000_0000
cho_siax_1931_0000_000_0000
cho_siax_1935_0002_000_0000
cho_siax_1936_0000_000_0000
cho_siax_1937_0000_000_0000
cho_siax_1938_0002_000_0000
cho_siax_1938_0003_000_0000
cho_siax_1939-1946_0001_000_0000
cho_siax_1939-1946_0005_000_0000
cho_siax_1939-1946_0006_000_0000
cho_siax_1939-1946_0008_000_0000
cho_siax_1939-1946_0009_000_0000
cho_siax_1951_0000_000_0000
cho_siax_1956-1958_0000_000_0000
cho_siax_1959-1960_0000_000_0000
cho_wtxx_1945_0001_000_0000
cho_wtxx_1945_0001_001_0000
cho_wtxx_1946_0002_000_0000
cho_wtxx_1946_0002_001_0000
cho_wtxx_1947_0003_000_0000
cho_wtxx_1947_0003_001_0000
cho_wtxx_1948_0004_000_0000
cho_wtxx_1948_0004_001_0000
cho_wtxx_1949_0005_001_0000
cho_wtxx_1950_0006_000_0000
cho_wtxx_1950_0006_001_0000
cho_wtxx_1951_0007_000_0000
cho_wtxx_1951_0007_001_0000
cho_wtxx_1952_0008_000_0000
cho_wtxx_1952_0008_001_0000
cho_wtxx_1953_0009_000_0000
cho_wtxx_1953_0009_001_0000
cho_wtxx_1954_0010_000_0000
cho_wtxx_1954_0010_001_0000
cho_wtxx_1955_0011_001_0000
cho_wtxx_1958_0014_000_0000
cho_wtxx_1959_0015_000_0000
cho_wtxx_1960_0016_000_0000
cho_wtxx_1964_0020_000_0000
cho_wtxx_1965_0021_000_0000
cho_wtxx_1966_0022_000_0000
cho_wtxx_1971_0027_000_0000
cho_wtxx_1973_0029_000_0000
cho_wtxx_1974_0030_000_0000
cho_wtxx_1975_0031_000_0000
cho_wtxx_1976_0032_000_0000
cho_wtxx_1978_0034_000_0000
"""
        item_str_list = self._get_item_str_list(from_excel)
        self._extract_latest_item_and_all_artifacts(gda, gda_folder, item_str_list)

        #gda_folder = '/mnt/UKDEV/pgref.fixed_xml'
        #self._supply_only_the_xml_to_qai(gda, gda_folder, item_str_list)

    def _get_item_str_list(self, from_excel):
        item_str_list = ""
        from_excel_string = StringIO.StringIO(from_excel)
        for line in from_excel_string:
            item_str_list += "'%s', " % line.replace('\n', '')

        return item_str_list[:-2]

    def _extract_latest_item_and_all_artifacts(self, gda, gda_folder, item_str_list):
        items_missing_from_gda = gda.get_live_items_from_gaia_db(item_str_list)

        gda.copy_all_item_versions_from_source_to_destination(items_missing_from_gda, '/mnt/nfs/gaia/web_root', gda_folder)
        gda.rm_gdom(items_missing_from_gda, gda_folder)

    def _supply_only_the_xml_to_qai(self, gda, gda_folder, item_str_list):

        items_missing_from_gda = gda.get_live_items_from_gaia_db(item_str_list)

        gda.login_to_gaia_website('http://10.179.176.181:8004/accounts/login/?next=/qa/')  # get CSCR


        for item in items_missing_from_gda:
            item_id, item_dom_name = gda.get_dom_id_dom_name(item)

            fixed_xml = gda.get_fixed_xml_from_gaia_ws(item_id, 'http://10.179.176.181:8004/qa/ws/v1.0/item/%s')
            try:
                with open('%s/%s.xml' % (gda_folder, item_dom_name), 'w') as f:
                    f.write(fixed_xml)
            except IOError as e:
                print str(e)



suite = unittest.TestSuite([
    unittest.TestLoader().loadTestsFromTestCase(TestGeneralExportUtil),
    ])
